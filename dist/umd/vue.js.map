{"version":3,"file":"vue.js","sources":["../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["/**\n * 处理响应式数据\n * 针对观测的对象 我们创建一个观测类去观测我们的data，因为有可能是观测对象 数组 其他的一些方法，将\n * 这些东西耦合在一起，做成一个功能\n */\n\nclass Observer {\n  constructor(value) {\n    // 使用 defineProperty 重新定义属性\n    this.walk(value);\n  }\n  walk(data) {\n    let keys = Object.keys(data);\n    keys.forEach((key) => {\n      defineRective(data, key, data[key]); // vue.util.defineRective\n    });\n  }\n}\n\nfunction defineRective(data, key, value) {\n  observe(value); // 如果值是对象类型，深度观测\n  Object.defineProperty(data, key, {\n    get() {\n      console.log('get 取值', data, key, value);\n      return value;\n    },\n    set(newValue) {\n      console.log('set 设置值', data, key, value);\n      if (newValue === value) return;\n      // 如果用户将值改为对象 继续监控\n      observe(newValue);\n      value = newValue;\n    },\n  });\n}\n\nexport function observe(data) {\n  // 观测对象\n  if (typeof data !== 'object' && data !== null) {\n    return;\n  }\n  return new Observer(data);\n}\n","import { observe } from './observer/index';\n\nexport function initState(vm) {\n  // vm.$options\n  // 针对不同的情况做 不同的初始化操作\n\n  let options = vm.$options;\n  if (options.props) {\n    initProps(vm);\n  }\n  if (options.methods) {\n    initMethods(vm);\n  }\n  if (options.data) {\n    initData(vm);\n  }\n  if (options.computed) {\n    initComputed(vm);\n  }\n  if (options.watch) {\n    initWatch(vm);\n  }\n}\n\nfunction initProps(vm) {}\nfunction initMethods(vm) {}\nfunction initData(vm) {\n  let data = vm.$options.data;\n  // data 有可能是函数 有可能是对象 _data 代理当前函数的返回值\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data;\n  observe(data);\n}\nfunction initComputed(vm) {}\nfunction initWatch(vm) {}\n","/**\n * 针对当前需要初始化的操作做一些初始化\n * 将我们的Vue传入 执行初始化操作\n * Vue 是一个什么框架 不是mvvm框架，只是参考了其思想而已，非说是，那不严格\n * mvvm 的特点 - 数据变化视图会更新，视图变化会影响数据 \n * mvvm有个条件，就是不能跳过数据去更新视图，但是vue中不遵循，比如 $ref 可以直接操作dom\n * \n */\n\nimport { initState } from \"./state\";\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    // 对实例拓展属性\n    const vm = this;\n    vm.$options = options;\n    // vue 核心特性 响应式原理\n    // 初始化状态 (将数据做一个初始化的拦截，当数据发生变更时，更新视图)\n    // vue组件中有很多状态，比如 data props watch computed 都和数据相关 \n    initState(vm)\n  };\n}\n","/**\n * 针对构造函数的原型拓展方法\n * es6的类的写法 是一个整体 不利于我们书写原型属性\n * 采用构造函数的形式 可以将对原型的拓展分散到不同的文件中\n *\n * 将各种方法整个成插件解耦出去，写成一个个插件对原型进行拓展\n */\n\nimport { initMixin } from './init';\nfunction Vue(options) {\n  this._init(options); // 入口方法 做初始化使用\n}\n\ninitMixin(Vue);\n\nexport default Vue;\n"],"names":["Observer","constructor","value","walk","data","keys","Object","forEach","key","defineRective","observe","defineProperty","get","console","log","set","newValue","initState","vm","options","$options","props","methods","initData","computed","watch","_data","call","initMixin","Vue","prototype","_init"],"mappings":";;;;;;EAAA;EACA;EACA;EACA;EACA;EAEA,MAAMA,QAAN,CAAe;EACbC,EAAAA,WAAW,CAACC,KAAD,EAAQ;EACjB;EACA,SAAKC,IAAL,CAAUD,KAAV;EACD;;EACDC,EAAAA,IAAI,CAACC,IAAD,EAAO;EACT,QAAIC,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYD,IAAZ,CAAX;EACAC,IAAAA,IAAI,CAACE,OAAL,CAAcC,GAAD,IAAS;EACpBC,MAAAA,aAAa,CAACL,IAAD,EAAOI,GAAP,EAAYJ,IAAI,CAACI,GAAD,CAAhB,CAAb,CADoB;EAErB,KAFD;EAGD;;EAVY;;EAaf,SAASC,aAAT,CAAuBL,IAAvB,EAA6BI,GAA7B,EAAkCN,KAAlC,EAAyC;EACvCQ,EAAAA,OAAO,CAACR,KAAD,CAAP,CADuC;;EAEvCI,EAAAA,MAAM,CAACK,cAAP,CAAsBP,IAAtB,EAA4BI,GAA5B,EAAiC;EAC/BI,IAAAA,GAAG,GAAG;EACJC,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBV,IAAtB,EAA4BI,GAA5B,EAAiCN,KAAjC;EACA,aAAOA,KAAP;EACD,KAJ8B;;EAK/Ba,IAAAA,GAAG,CAACC,QAAD,EAAW;EACZH,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBV,IAAvB,EAA6BI,GAA7B,EAAkCN,KAAlC;EACA,UAAIc,QAAQ,KAAKd,KAAjB,EAAwB,OAFZ;;EAIZQ,MAAAA,OAAO,CAACM,QAAD,CAAP;EACAd,MAAAA,KAAK,GAAGc,QAAR;EACD;;EAX8B,GAAjC;EAaD;;EAEM,SAASN,OAAT,CAAiBN,IAAjB,EAAuB;EAC5B;EACA,MAAI,OAAOA,IAAP,KAAgB,QAAhB,IAA4BA,IAAI,KAAK,IAAzC,EAA+C;EAC7C;EACD;;EACD,SAAO,IAAIJ,QAAJ,CAAaI,IAAb,CAAP;EACD;;ECxCM,SAASa,SAAT,CAAmBC,EAAnB,EAAuB;EAC5B;EACA;EAEA,MAAIC,OAAO,GAAGD,EAAE,CAACE,QAAjB;;EACA,MAAID,OAAO,CAACE,KAAZ,EAAmB;;EAGnB,MAAIF,OAAO,CAACG,OAAZ,EAAqB;;EAGrB,MAAIH,OAAO,CAACf,IAAZ,EAAkB;EAChBmB,IAAAA,QAAQ,CAACL,EAAD,CAAR;EACD;;EACD,MAAIC,OAAO,CAACK,QAAZ,EAAsB;;EAGtB,MAAIL,OAAO,CAACM,KAAZ,EAAmB;EAGpB;;EAID,SAASF,QAAT,CAAkBL,EAAlB,EAAsB;EACpB,MAAId,IAAI,GAAGc,EAAE,CAACE,QAAH,CAAYhB,IAAvB,CADoB;;EAGpBc,EAAAA,EAAE,CAACQ,KAAH,GAAWtB,IAAI,GAAG,OAAOA,IAAP,KAAgB,UAAhB,GAA6BA,IAAI,CAACuB,IAAL,CAAUT,EAAV,CAA7B,GAA6Cd,IAA/D;EACAM,EAAAA,OAAO,CAACN,IAAD,CAAP;EACD;;EC/BD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EAIO,SAASwB,SAAT,CAAmBC,GAAnB,EAAwB;EAC7BA,EAAAA,GAAG,CAACC,SAAJ,CAAcC,KAAd,GAAsB,UAAUZ,OAAV,EAAmB;EACvC;EACA,UAAMD,EAAE,GAAG,IAAX;EACAA,IAAAA,EAAE,CAACE,QAAH,GAAcD,OAAd,CAHuC;EAKvC;EACA;;EACAF,IAAAA,SAAS,CAACC,EAAD,CAAT;EACD,GARD;EASD;;ECrBD;EACA;EACA;EACA;EACA;EACA;EACA;;EAGA,SAASW,GAAT,CAAaV,OAAb,EAAsB;EACpB,OAAKY,KAAL,CAAWZ,OAAX,EADoB;;EAErB;;EAEDS,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}